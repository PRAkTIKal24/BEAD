

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bead.src.utils package &mdash; bead 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="bead.src.trainers package" href="bead.src.trainers.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bead
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">bead</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="bead.html">bead package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="bead.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="bead.src.html">bead.src package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="bead.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="bead.html#module-bead.bead">bead.bead module</a></li>
<li class="toctree-l3"><a class="reference internal" href="bead.html#module-bead">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bead</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">bead</a></li>
          <li class="breadcrumb-item"><a href="bead.html">bead package</a></li>
          <li class="breadcrumb-item"><a href="bead.src.html">bead.src package</a></li>
      <li class="breadcrumb-item active">bead.src.utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/bead.src.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bead-src-utils-package">
<h1>bead.src.utils package<a class="headerlink" href="#bead-src-utils-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-bead.src.utils.conversion">
<span id="bead-src-utils-conversion-module"></span><h2>bead.src.utils.conversion module<a class="headerlink" href="#module-bead.src.utils.conversion" title="Link to this heading"></a></h2>
<p>Data conversion utilities for CSV to HDF5/NumPy.</p>
<p>This module contains functions to convert CSV files to HDF5 and .npy files in parallel.
It handles efficient reading and processing of large CSV files with event, jet, and
constituent-level data, and saves them in a structured format for later analysis.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>calculate_jet_properties_numba: Numba-accelerated calculation of jet properties.
process_event: Process a single event row from CSV.
csv_chunk_generator: Generator yielding CSV file chunks to process.
append_to_hdf5: Append data chunk to HDF5 dataset.
process_chunk: Process a chunk of CSV rows into homogeneous arrays.
convert_csv_to_hdf5_npy_parallel: Main function to convert CSV to HDF5/NumPy.</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.conversion.append_to_hdf5">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.conversion.</span></span><span class="sig-name descname"><span class="pre">append_to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_chunk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/conversion.html#append_to_hdf5"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.conversion.append_to_hdf5" title="Link to this definition"></a></dt>
<dd><p>Append a data chunk to an existing resizable HDF5 dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.conversion.calculate_jet_properties_numba">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.conversion.</span></span><span class="sig-name descname"><span class="pre">calculate_jet_properties_numba</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pt_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta_arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi_arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/conversion.html#calculate_jet_properties_numba"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.conversion.calculate_jet_properties_numba" title="Link to this definition"></a></dt>
<dd><p>Numba-accelerated calculation of jet properties using vectorized NumPy operations.
Processes all constituents in a jet simultaneously.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.conversion.convert_csv_to_hdf5_npy_parallel">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.conversion.</span></span><span class="sig-name descname"><span class="pre">convert_csv_to_hdf5_npy_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/conversion.html#convert_csv_to_hdf5_npy_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.conversion.convert_csv_to_hdf5_npy_parallel" title="Link to this definition"></a></dt>
<dd><p>Convert CSV to HDF5 (or .npy) using homogeneous 2D arrays.
Here, we build each dataset as a 2D array (with fixed number of columns)
so that later you can access columns by index (e.g. jets[:,4] for jet_pt).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.conversion.csv_chunk_generator">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.conversion.</span></span><span class="sig-name descname"><span class="pre">csv_chunk_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">csv_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/conversion.html#csv_chunk_generator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.conversion.csv_chunk_generator" title="Link to this definition"></a></dt>
<dd><p>Generator yielding CSV file chunks (lists of rows) to avoid loading the entire file.
Skips empty rows and rows with ‘evtwt’ in the first column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.conversion.process_chunk">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.conversion.</span></span><span class="sig-name descname"><span class="pre">process_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_evt_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/conversion.html#process_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.conversion.process_chunk" title="Link to this definition"></a></dt>
<dd><p>Process a chunk of CSV rows into homogeneous 2D arrays.
Instead of creating structured arrays (with named fields), we build
plain lists of lists and convert them to a homogeneous NumPy array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.conversion.process_event">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.conversion.</span></span><span class="sig-name descname"><span class="pre">process_event</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evt_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/conversion.html#process_event"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.conversion.process_event" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Process a single event row:</dt><dd><ul class="simple">
<li><p>Convert string data to floats.</p></li>
<li><p>Extract event-level data.</p></li>
<li><p>Loop over jets and their constituents.</p></li>
<li><p>Use vectorized (Numba) calculation for jet properties.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bead.src.utils.data_processing">
<span id="bead-src-utils-data-processing-module"></span><h2>bead.src.utils.data_processing module<a class="headerlink" href="#module-bead.src.utils.data_processing" title="Link to this heading"></a></h2>
<p>Data processing utilities for HDF5/NumPy arrays.</p>
<p>This module provides functions for loading, processing, and preparing data for training
and inference. It includes utilities for selecting the top jets and constituents, normalizing
data, and converting between different data formats.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>load_data: Load data from HDF5 files.
select_top_jets_and_constituents: Select top N jets and M constituents.
process_and_save_tensors: Process input file and save as PyTorch tensors.
preproc_inputs: Preprocess inputs for training or inference.</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.data_processing.compute_efp_features">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.data_processing.</span></span><span class="sig-name descname"><span class="pre">compute_efp_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">constituents_selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_constits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/data_processing.html#compute_efp_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.data_processing.compute_efp_features" title="Link to this definition"></a></dt>
<dd><p>Compute EFP features for the selected constituents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>constituents_selection</strong> – Array of shape (num_events, n_jets * n_constits, features)</p></li>
<li><p><strong>config</strong> – Configuration object with EFP parameters</p></li>
<li><p><strong>n_jets</strong> – Number of jets per event</p></li>
<li><p><strong>n_constits</strong> – Number of constituents per jet</p></li>
<li><p><strong>verbose</strong> – Whether to print progress information</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>EFP features of shape (num_events, n_jets, n_efps)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.data_processing.load_data">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.data_processing.</span></span><span class="sig-name descname"><span class="pre">load_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/data_processing.html#load_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.data_processing.load_data" title="Link to this definition"></a></dt>
<dd><p>Load data from either an HDF5 file or .npy files.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.data_processing.preproc_inputs">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.data_processing.</span></span><span class="sig-name descname"><span class="pre">preproc_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/data_processing.html#preproc_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.data_processing.preproc_inputs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.data_processing.process_and_save_tensors">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.data_processing.</span></span><span class="sig-name descname"><span class="pre">process_and_save_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/data_processing.html#process_and_save_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.data_processing.process_and_save_tensors" title="Link to this definition"></a></dt>
<dd><p>Process the input file, parallelize selections, and save the results as PyTorch tensors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.data_processing.select_top_jets_and_constituents">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.data_processing.</span></span><span class="sig-name descname"><span class="pre">select_top_jets_and_constituents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_constits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/data_processing.html#select_top_jets_and_constituents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.data_processing.select_top_jets_and_constituents" title="Link to this definition"></a></dt>
<dd><p>Select top n_jets per event and, for each selected jet, top n_constits constituents.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(num_events, n_jets, jets.shape[1])
constits_out: (num_events, n_jets * n_constits, constituents.shape[1])</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>jets_out</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bead.src.utils.diagnostics">
<span id="bead-src-utils-diagnostics-module"></span><h2>bead.src.utils.diagnostics module<a class="headerlink" href="#module-bead.src.utils.diagnostics" title="Link to this heading"></a></h2>
<p>Diagnostic utilities for model analysis and profiling.</p>
<p>This module provides functions for extracting and visualizing neural network activations,
profiling model performance, and generating diagnostic plots for understanding model behavior.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>get_mean_node_activations: Calculate mean activations for each node.
dict_to_square_matrix: Convert activation dictionary to square matrix.
plot: Generate neural activation pattern plot.
nap_diagnose: Neural activation pattern diagnosis.
pytorch_profile: Profile PyTorch code execution.
c_profile: Profile Python code execution with cProfile.</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.diagnostics.c_profile">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.diagnostics.</span></span><span class="sig-name descname"><span class="pre">c_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/diagnostics.html#c_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.diagnostics.c_profile" title="Link to this definition"></a></dt>
<dd><p>Profile the function func with cProfile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to be profiled.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the function <cite>func</cite> execution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>result</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.diagnostics.dict_to_square_matrix">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.diagnostics.</span></span><span class="sig-name descname"><span class="pre">dict_to_square_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">array</span></span></span><a class="reference internal" href="_modules/bead/src/utils/diagnostics.html#dict_to_square_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.diagnostics.dict_to_square_matrix" title="Link to this definition"></a></dt>
<dd><p>Function changes an input dictionary into a square np.array. Adds NaNs when the dimension of a dict key is less than of the final square matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_dict</strong> (<em>dict</em>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>square_matrix (np.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.diagnostics.get_mean_node_activations">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.diagnostics.</span></span><span class="sig-name descname"><span class="pre">get_mean_node_activations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/bead/src/utils/diagnostics.html#get_mean_node_activations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.diagnostics.get_mean_node_activations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.diagnostics.nap_diagnose">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.diagnostics.</span></span><span class="sig-name descname"><span class="pre">nap_diagnose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bead/src/utils/diagnostics.html#nap_diagnose"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.diagnostics.nap_diagnose" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.diagnostics.plot">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.diagnostics.</span></span><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bead/src/utils/diagnostics.html#plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.diagnostics.plot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.diagnostics.pytorch_profile">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.diagnostics.</span></span><span class="sig-name descname"><span class="pre">pytorch_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/diagnostics.html#pytorch_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.diagnostics.pytorch_profile" title="Link to this definition"></a></dt>
<dd><p>This function performs PyTorch profiling of CPU, GPU time and memory
consumed by the function f execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>callable</em>) – The function to be profiled.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the function <cite>f</cite> execution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>result</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bead.src.utils.ggl">
<span id="bead-src-utils-ggl-module"></span><h2>bead.src.utils.ggl module<a class="headerlink" href="#module-bead.src.utils.ggl" title="Link to this heading"></a></h2>
<p>Control center for BEAD command-line interface.</p>
<p>This module serves as the main entry point for the BEAD CLI. It handles command-line arguments, project creation, and orchestrates the execution of various modes like data conversion, training, inference, and visualization.
Think of this file as your google assistant
This file is a collection of simple helper functions and is the control center that accesses all other src files</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>get_arguments: Parse command-line arguments.
create_default_config: Create default configuration file.
create_new_project: Create directory structure for new project.
convert_csv: Convert CSV files to HDF5 or NumPy format.
prepare_inputs: Process input data and create tensors.
run_training: Execute model training pipeline.
run_inference: Execute model inference pipeline.
run_plots: Generate plots from results.
run_diagnostics: Run model diagnostics.
run_full_chain: Execute a sequence of operations.</p>
</dd>
<dt>Classes:</dt><dd><p>Config: Dataclass for storing configuration settings.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">Config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workspace_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_jets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_constits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_space_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalizations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_normalizations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stopping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_stoppin_patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_scheduler_patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latent_space_plot_style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ddp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_amp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermittent_model_saving</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermittent_saving_patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_extraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic_algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate_model_saving</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subsample_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrastive_temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contrastive_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay_roc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay_roc_projects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay_roc_save_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay_roc_filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntxent_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_nmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_dmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_extended_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_beta_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_measure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'hadr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_normed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_include_composites</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_embedding_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_gate_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_gate_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_dropout_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_use_layer_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_monitor_sparsity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_standardize_meanvar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_n_jobs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_feature_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'EFP_'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_use_true_energy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_transformer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'combined'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_d_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_n_heads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_n_layers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_d_ff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2048</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gelu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_norm_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_use_class_attention</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_max_jets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_output_activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_positional_encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sinusoidal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_token_type_embeddings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_gradient_checkpointing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_attention_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer_layer_norm_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#Config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.Config" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines a configuration dataclass</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.activation_extraction">
<span class="sig-name descname"><span class="pre">activation_extraction</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.activation_extraction" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.batch_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.chunk_size">
<span class="sig-name descname"><span class="pre">chunk_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.chunk_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.contrastive_temperature">
<span class="sig-name descname"><span class="pre">contrastive_temperature</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.contrastive_temperature" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.contrastive_weight">
<span class="sig-name descname"><span class="pre">contrastive_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.contrastive_weight" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.deterministic_algorithm">
<span class="sig-name descname"><span class="pre">deterministic_algorithm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.deterministic_algorithm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.early_stoppin_patience">
<span class="sig-name descname"><span class="pre">early_stoppin_patience</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.early_stoppin_patience" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.early_stopping">
<span class="sig-name descname"><span class="pre">early_stopping</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.early_stopping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_beta">
<span class="sig-name descname"><span class="pre">efp_beta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_beta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_beta_list">
<span class="sig-name descname"><span class="pre">efp_beta_list</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_beta_list" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_cache_dir">
<span class="sig-name descname"><span class="pre">efp_cache_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_cache_dir" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_device">
<span class="sig-name descname"><span class="pre">efp_device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'cpu'</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_dmax">
<span class="sig-name descname"><span class="pre">efp_dmax</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_dmax" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_dropout_rate">
<span class="sig-name descname"><span class="pre">efp_dropout_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_dropout_rate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_embedding_dim">
<span class="sig-name descname"><span class="pre">efp_embedding_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">64</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_embedding_dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_eps">
<span class="sig-name descname"><span class="pre">efp_eps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-12</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_extended_mode">
<span class="sig-name descname"><span class="pre">efp_extended_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_extended_mode" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_feature_prefix">
<span class="sig-name descname"><span class="pre">efp_feature_prefix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'EFP_'</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_feature_prefix" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_gate_threshold">
<span class="sig-name descname"><span class="pre">efp_gate_threshold</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.05</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_gate_threshold" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_gate_type">
<span class="sig-name descname"><span class="pre">efp_gate_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sigmoid'</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_gate_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_include_composites">
<span class="sig-name descname"><span class="pre">efp_include_composites</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_include_composites" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_measure">
<span class="sig-name descname"><span class="pre">efp_measure</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'hadr'</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_measure" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_mode">
<span class="sig-name descname"><span class="pre">efp_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_mode" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_monitor_sparsity">
<span class="sig-name descname"><span class="pre">efp_monitor_sparsity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_monitor_sparsity" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_n_jobs">
<span class="sig-name descname"><span class="pre">efp_n_jobs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_n_jobs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_nmax">
<span class="sig-name descname"><span class="pre">efp_nmax</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_nmax" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_normed">
<span class="sig-name descname"><span class="pre">efp_normed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_normed" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_standardize_meanvar">
<span class="sig-name descname"><span class="pre">efp_standardize_meanvar</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_standardize_meanvar" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_use_layer_norm">
<span class="sig-name descname"><span class="pre">efp_use_layer_norm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_use_layer_norm" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.efp_use_true_energy">
<span class="sig-name descname"><span class="pre">efp_use_true_energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.efp_use_true_energy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.enable_transformer">
<span class="sig-name descname"><span class="pre">enable_transformer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.enable_transformer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.epochs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.file_type">
<span class="sig-name descname"><span class="pre">file_type</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.file_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.input_features">
<span class="sig-name descname"><span class="pre">input_features</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.input_features" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.input_level">
<span class="sig-name descname"><span class="pre">input_level</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.input_level" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.intermittent_model_saving">
<span class="sig-name descname"><span class="pre">intermittent_model_saving</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.intermittent_model_saving" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.intermittent_saving_patience">
<span class="sig-name descname"><span class="pre">intermittent_saving_patience</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.intermittent_saving_patience" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.invert_normalizations">
<span class="sig-name descname"><span class="pre">invert_normalizations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.invert_normalizations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.latent_space_plot_style">
<span class="sig-name descname"><span class="pre">latent_space_plot_style</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.latent_space_plot_style" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.latent_space_size">
<span class="sig-name descname"><span class="pre">latent_space_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.latent_space_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.loss_function">
<span class="sig-name descname"><span class="pre">loss_function</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.loss_function" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.lr">
<span class="sig-name descname"><span class="pre">lr</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.lr" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.lr_scheduler">
<span class="sig-name descname"><span class="pre">lr_scheduler</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.lr_scheduler" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.lr_scheduler_patience">
<span class="sig-name descname"><span class="pre">lr_scheduler_patience</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.lr_scheduler_patience" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.min_delta">
<span class="sig-name descname"><span class="pre">min_delta</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.min_delta" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.model_init">
<span class="sig-name descname"><span class="pre">model_init</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.model_init" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.model_name">
<span class="sig-name descname"><span class="pre">model_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.model_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.normalizations">
<span class="sig-name descname"><span class="pre">normalizations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.normalizations" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.ntxent_sigma">
<span class="sig-name descname"><span class="pre">ntxent_sigma</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.ntxent_sigma" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.num_constits">
<span class="sig-name descname"><span class="pre">num_constits</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.num_constits" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.num_jets">
<span class="sig-name descname"><span class="pre">num_jets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.num_jets" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.optimizer">
<span class="sig-name descname"><span class="pre">optimizer</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.optimizer" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.overlay_roc">
<span class="sig-name descname"><span class="pre">overlay_roc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.overlay_roc" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.overlay_roc_filename">
<span class="sig-name descname"><span class="pre">overlay_roc_filename</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.overlay_roc_filename" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.overlay_roc_projects">
<span class="sig-name descname"><span class="pre">overlay_roc_projects</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.overlay_roc_projects" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.overlay_roc_save_location">
<span class="sig-name descname"><span class="pre">overlay_roc_save_location</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.overlay_roc_save_location" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.parallel_workers">
<span class="sig-name descname"><span class="pre">parallel_workers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.parallel_workers" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.project_name">
<span class="sig-name descname"><span class="pre">project_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.project_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.reg_param">
<span class="sig-name descname"><span class="pre">reg_param</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.reg_param" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.separate_model_saving">
<span class="sig-name descname"><span class="pre">separate_model_saving</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.separate_model_saving" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.subsample_plot">
<span class="sig-name descname"><span class="pre">subsample_plot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.subsample_plot" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.subsample_size">
<span class="sig-name descname"><span class="pre">subsample_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.subsample_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.train_size">
<span class="sig-name descname"><span class="pre">train_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.train_size" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_activation">
<span class="sig-name descname"><span class="pre">transformer_activation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'gelu'</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_activation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_attention_dropout">
<span class="sig-name descname"><span class="pre">transformer_attention_dropout</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_attention_dropout" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_d_ff">
<span class="sig-name descname"><span class="pre">transformer_d_ff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2048</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_d_ff" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_d_model">
<span class="sig-name descname"><span class="pre">transformer_d_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">256</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_d_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_dropout">
<span class="sig-name descname"><span class="pre">transformer_dropout</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_dropout" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_gradient_checkpointing">
<span class="sig-name descname"><span class="pre">transformer_gradient_checkpointing</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_gradient_checkpointing" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_layer_norm_eps">
<span class="sig-name descname"><span class="pre">transformer_layer_norm_eps</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-05</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_layer_norm_eps" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_max_jets">
<span class="sig-name descname"><span class="pre">transformer_max_jets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_max_jets" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_mode">
<span class="sig-name descname"><span class="pre">transformer_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'combined'</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_mode" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_n_heads">
<span class="sig-name descname"><span class="pre">transformer_n_heads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_n_heads" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_n_layers">
<span class="sig-name descname"><span class="pre">transformer_n_layers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">6</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_n_layers" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_norm_first">
<span class="sig-name descname"><span class="pre">transformer_norm_first</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_norm_first" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_output_activation">
<span class="sig-name descname"><span class="pre">transformer_output_activation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_output_activation" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_output_dim">
<span class="sig-name descname"><span class="pre">transformer_output_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_output_dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_positional_encoding">
<span class="sig-name descname"><span class="pre">transformer_positional_encoding</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sinusoidal'</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_positional_encoding" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_token_type_embeddings">
<span class="sig-name descname"><span class="pre">transformer_token_type_embeddings</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_token_type_embeddings" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.transformer_use_class_attention">
<span class="sig-name descname"><span class="pre">transformer_use_class_attention</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.transformer_use_class_attention" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.use_amp">
<span class="sig-name descname"><span class="pre">use_amp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.use_amp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.use_ddp">
<span class="sig-name descname"><span class="pre">use_ddp</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.use_ddp" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.ggl.Config.workspace_name">
<span class="sig-name descname"><span class="pre">workspace_name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#bead.src.utils.ggl.Config.workspace_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.convert_csv">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">convert_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#convert_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.convert_csv" title="Link to this definition"></a></dt>
<dd><p>Convert the input ‘’.csv’ into the file_type selected in the config file (‘.h5’ by default)</p>
<blockquote>
<div><p>Separate event-level, jet-level and constituent-level data into separate datasets/files.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<em>path</em>) – Path to the input csv files</p></li>
<li><p><strong>output_path</strong> (<em>path</em>) – Selects base path for determining output path</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints out more information</p></li>
</ul>
</dd>
</dl>
<dl>
<dt>Outputs:</dt><dd><p>A <cite>ProjectName_OutputPrefix.h5</cite> file which includes:
- Event-level dataset
- Jet-level dataset
- Constituent-level dataset</p>
<p>or</p>
<p>A <cite>ProjectName_OutputPrefix_{data-level}.npy</cite> files which contain the same information as above, split into 3 separate files.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.create_default_config">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">create_default_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workspace_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#create_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.create_default_config" title="Link to this definition"></a></dt>
<dd><p>Creates a default config file for a project.
:param workspace_name: Name of the workspace.
:type workspace_name: str
:param project_name: Name of the project.
:type project_name: str</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Default config file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.create_new_project">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">create_new_project</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workspace_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'bead/workspaces'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#create_new_project"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.create_new_project" title="Link to this definition"></a></dt>
<dd><p>Creates a new project directory output subdirectories and config files within a workspace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workspace_name</strong> (<em>str</em>) – Creates a workspace (dir) for storing data and projects with this name.</p></li>
<li><p><strong>project_name</strong> (<em>str</em>) – Creates a project (dir) for storing configs and outputs with this name.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print out the progress. Defaults to False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.get_arguments">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">get_arguments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#get_arguments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.get_arguments" title="Link to this definition"></a></dt>
<dd><p>Determines commandline arguments specified by BEAD user. Use <cite>–help</cite> to see what
options are available.</p>
<p>Returns: .py, string, folder: <cite>.py</cite> file containing the config options, string determining what mode to run,
projects directory where outputs go.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.prepare_inputs">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">prepare_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#prepare_inputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.prepare_inputs" title="Link to this definition"></a></dt>
<dd><p>Read the input data and generate torch tensors ready to train on.</p>
<p>Select number of leading jets per event and number of leading constituents per jet to be used for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> – Dictionary of common paths used in the pipeline</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints out more information</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Outputs:</dt><dd><p>Tensor files which include:
- Event-level dataset - [evt_id, evt_weight, met, met_phi, num_jets]
- Jet-level dataset - [evt_id, jet_id, num_constituents, jet_btag, jet_pt, jet_eta, jet_phi]
- Constituent-level dataset - [evt_id, jet_id, constituent_id, jet_btag, constituent_pt, constituent_eta, constituent_phi]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.run_diagnostics">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">run_diagnostics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">project_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#run_diagnostics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.run_diagnostics" title="Link to this definition"></a></dt>
<dd><p>Calls diagnostics.diagnose()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_path</strong> (<em>str</em>) – path to the np.array contataining the activations values</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – path to store the diagnostics pdf</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.run_full_chain">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">run_full_chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workspace_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#run_full_chain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.run_full_chain" title="Link to this definition"></a></dt>
<dd><p>Execute a sequence of operations based on the provided options string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>workspace_name</strong> – Name of the workspace for new projects</p></li>
<li><p><strong>project_name</strong> – Name of the project for new projects</p></li>
<li><p><strong>paths</strong> – Dictionary of file paths and directories</p></li>
<li><p><strong>config</strong> – Configuration dictionary for operations</p></li>
<li><p><strong>options</strong> – Underscore-separated string specifying the workflow sequence</p></li>
<li><p><strong>verbose</strong> – Whether to show verbose output</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<dl class="simple">
<dt>run_full_chain(“my_workspace”, “my_project”, paths, config,</dt><dd><p>“newproject_convertcsv_prepareinputs_train_detect”, verbose=True)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.run_inference">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">run_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#run_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.run_inference" title="Link to this definition"></a></dt>
<dd><p>Main function calling the training functions, ran when –mode=train is selected.
The three functions called are: <cite>process</cite>, <cite>ggl.mode_init</cite> and <cite>training.train</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> (<em>dictionary</em>) – Dictionary of common paths used in the pipeline</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints out more information</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.run_plots">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">run_plots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#run_plots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.run_plots" title="Link to this definition"></a></dt>
<dd><p>Main function calling the plotting functions, ran when –mode=plot is selected.
The main functions this calls are: <cite>plotting.plot_losses</cite>, <cite>plotting.plot_latent_variables</cite>,
plotting.plot_mu_logvar and <cite>plotting.plot_roc_curve</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> (<em>dictionary</em>) – Dictionary of common paths used in the pipeline</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints out more information</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.ggl.run_training">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.ggl.</span></span><span class="sig-name descname"><span class="pre">run_training</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/ggl.html#run_training"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.ggl.run_training" title="Link to this definition"></a></dt>
<dd><p>Main function calling the training functions, ran when –mode=train is selected.
The three functions called are: ‘data_processing.preproc_inputs’ and <cite>training.train</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>paths</strong> (<em>dictionary</em>) – Dictionary of common paths used in the pipeline</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, prints out more information</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bead.src.utils.helper">
<span id="bead-src-utils-helper-module"></span><h2>bead.src.utils.helper module<a class="headerlink" href="#module-bead.src.utils.helper" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.helper.ChainedScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">ChainedScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#ChainedScaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.ChainedScaler" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerMixin</span></code></p>
<p>Chains a list of scaler transformations.
The transformation is applied sequentially (in the order provided)
and the inverse transformation is applied in reverse order.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.ChainedScaler.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#ChainedScaler.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.ChainedScaler.fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.ChainedScaler.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#ChainedScaler.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.ChainedScaler.inverse_transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.ChainedScaler.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#ChainedScaler.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.ChainedScaler.transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.helper.CustomDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">CustomDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_tensor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#CustomDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.CustomDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<p>A custom PyTorch Dataset for handling paired data and label tensors, with optional EFP features.</p>
<p>This dataset provides a simple interface for accessing data points and their
corresponding labels, which is compatible with PyTorch’s DataLoader.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.helper.CustomDataset.data">
<span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#bead.src.utils.helper.CustomDataset.data" title="Link to this definition"></a></dt>
<dd><p>The data tensor containing features.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.helper.CustomDataset.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><a class="headerlink" href="#bead.src.utils.helper.CustomDataset.labels" title="Link to this definition"></a></dt>
<dd><p>The labels tensor associated with the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.helper.CustomDataset.efp_data">
<span class="sig-name descname"><span class="pre">efp_data</span></span><a class="headerlink" href="#bead.src.utils.helper.CustomDataset.efp_data" title="Link to this definition"></a></dt>
<dd><p>The EFP features tensor. None if not provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor, optional</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.helper.EarlyStopping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">EarlyStopping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#EarlyStopping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.EarlyStopping" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to perform early stopping during model training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patience</strong> (<em>int</em>) – The number of epochs to wait before stopping the training process if the validation loss doesn’t improve.</p></li>
<li><p><strong>min_delta</strong> (<em>float</em>) – The minimum difference between the new loss and the previous best loss for the new loss to be considered an improvement.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.helper.EarlyStopping.counter">
<span class="sig-name descname"><span class="pre">counter</span></span><a class="headerlink" href="#bead.src.utils.helper.EarlyStopping.counter" title="Link to this definition"></a></dt>
<dd><p>Counts the number of times the validation loss hasn’t improved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.helper.EarlyStopping.best_loss">
<span class="sig-name descname"><span class="pre">best_loss</span></span><a class="headerlink" href="#bead.src.utils.helper.EarlyStopping.best_loss" title="Link to this definition"></a></dt>
<dd><p>The best validation loss observed so far.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.helper.EarlyStopping.early_stop">
<span class="sig-name descname"><span class="pre">early_stop</span></span><a class="headerlink" href="#bead.src.utils.helper.EarlyStopping.early_stop" title="Link to this definition"></a></dt>
<dd><p>Flag that indicates whether early stopping criteria have been met.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.helper.L2Normalizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">L2Normalizer</span></span><a class="reference internal" href="_modules/bead/src/utils/helper.html#L2Normalizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.L2Normalizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerMixin</span></code></p>
<p>L2 normalization per feature of data</p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.L2Normalizer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#L2Normalizer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.L2Normalizer.fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.L2Normalizer.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#L2Normalizer.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.L2Normalizer.inverse_transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.L2Normalizer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#L2Normalizer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.L2Normalizer.transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.helper.LRScheduler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">LRScheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#LRScheduler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.LRScheduler" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A learning rate scheduler that adjusts the learning rate of an optimizer based on the training loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<em>torch.optim.Optimizer</em>) – The optimizer whose learning rate will be adjusted.</p></li>
<li><p><strong>patience</strong> (<em>int</em>) – The number of epochs with no improvement in training loss after which the learning rate will be reduced.</p></li>
<li><p><strong>min_lr</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum learning rate that can be reached (default: 1e-6).</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The factor by which the learning rate will be reduced (default: 0.1).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="bead.src.utils.helper.LRScheduler.lr_scheduler">
<span class="sig-name descname"><span class="pre">lr_scheduler</span></span><a class="headerlink" href="#bead.src.utils.helper.LRScheduler.lr_scheduler" title="Link to this definition"></a></dt>
<dd><p>The PyTorch learning rate scheduler that actually performs the adjustments.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.optim.lr_scheduler.ReduceLROnPlateau</p>
</dd>
</dl>
</dd></dl>

<dl class="simple">
<dt>Example usage:</dt><dd><p>optimizer = torch.optim.Adam(model.parameters(), lr=0.01)
lr_scheduler = LRScheduler(optimizer, patience=3, min_lr=1e-6, factor=0.5)
for epoch in range(num_epochs):
train_loss = train(model, train_data_loader)
lr_scheduler(train_loss)
# …</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.helper.Log1pScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">Log1pScaler</span></span><a class="reference internal" href="_modules/bead/src/utils/helper.html#Log1pScaler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.Log1pScaler" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerMixin</span></code></p>
<p>Log(1+x) transformer for positive-skewed HEP features</p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.Log1pScaler.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#Log1pScaler.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.Log1pScaler.fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.Log1pScaler.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#Log1pScaler.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.Log1pScaler.inverse_transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.Log1pScaler.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#Log1pScaler.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.Log1pScaler.transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.helper.SinCosTransformer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">SinCosTransformer</span></span><a class="reference internal" href="_modules/bead/src/utils/helper.html#SinCosTransformer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.SinCosTransformer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">TransformerMixin</span></code></p>
<p>Transforms an angle (in radians) into two features:
[sin(angle), cos(angle)]. Inverse transformation uses arctan2.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.SinCosTransformer.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#SinCosTransformer.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.SinCosTransformer.fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.SinCosTransformer.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#SinCosTransformer.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.SinCosTransformer.inverse_transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.helper.SinCosTransformer.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#SinCosTransformer.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.SinCosTransformer.transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.add_sig_bkg_label">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">add_sig_bkg_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/bead/src/utils/helper.html#add_sig_bkg_label"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.add_sig_bkg_label" title="Link to this definition"></a></dt>
<dd><p>Adds a new feature to the last dimension of each tensor in the tuple.
The new feature is filled with 0 for “bkg” and 1 for “sig”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensors</strong> – A tuple of three tensors (events, jets, constituents).</p></li>
<li><p><strong>label</strong> – A string, either “bkg” or “sig”, to determine the value of the new feature.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the three tensors with the new feature added to the last dimension.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.calculate_in_shape">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">calculate_in_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#calculate_in_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.calculate_in_shape" title="Link to this definition"></a></dt>
<dd><p>Calculates the input shapes for the models based on the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – The data you wish to calculate the input shapes for.</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs.</p></li>
<li><p><strong>test_mode</strong> (<em>bool</em>) – A flag to indicate if the function is being called in test mode.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the input shapes for the models.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.call_forward">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">call_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#call_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.call_forward" title="Link to this definition"></a></dt>
<dd><p>Calls the <cite>forward</cite> method of the given object.
If the return value is not a tuple, packs it into a tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – An object that has a <cite>forward</cite> method.</p></li>
<li><p><strong>inputs</strong> – The input data to pass to the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the result(s) of the <cite>forward</cite> method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.convert_to_tensor">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">convert_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#convert_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.convert_to_tensor" title="Link to this definition"></a></dt>
<dd><p>Converts ndarray to torch.Tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>ndarray</em>) – The data you wish to convert from ndarray to torch.Tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Your data as a tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.create_datasets">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">create_datasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">events_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jets_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jets_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events_train_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jets_train_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents_train_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events_val_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jets_val_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents_val_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_train_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">efp_val_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#create_datasets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.create_datasets" title="Link to this definition"></a></dt>
<dd><p>Creates CustomDataset objects for training and validation data.</p>
<p>This function pairs data tensors with their corresponding label tensors
to create dataset objects for events, jets, constituents, and optionally EFP data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>events_train</strong> (<em>torch.Tensor</em>) – Training events data.</p></li>
<li><p><strong>jets_train</strong> (<em>torch.Tensor</em>) – Training jets data.</p></li>
<li><p><strong>constituents_train</strong> (<em>torch.Tensor</em>) – Training constituents data.</p></li>
<li><p><strong>events_val</strong> (<em>torch.Tensor</em>) – Validation events data.</p></li>
<li><p><strong>jets_val</strong> (<em>torch.Tensor</em>) – Validation jets data.</p></li>
<li><p><strong>constituents_val</strong> (<em>torch.Tensor</em>) – Validation constituents data.</p></li>
<li><p><strong>events_train_label</strong> (<em>torch.Tensor</em>) – Labels for training events.</p></li>
<li><p><strong>jets_train_label</strong> (<em>torch.Tensor</em>) – Labels for training jets.</p></li>
<li><p><strong>constituents_train_label</strong> (<em>torch.Tensor</em>) – Labels for training constituents.</p></li>
<li><p><strong>events_val_label</strong> (<em>torch.Tensor</em>) – Labels for validation events.</p></li>
<li><p><strong>jets_val_label</strong> (<em>torch.Tensor</em>) – Labels for validation jets.</p></li>
<li><p><strong>constituents_val_label</strong> (<em>torch.Tensor</em>) – Labels for validation constituents.</p></li>
<li><p><strong>efp_train</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Training EFP features data.</p></li>
<li><p><strong>efp_val</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Validation EFP features data.</p></li>
<li><p><strong>efp_train_label</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Labels for training EFP features.</p></li>
<li><p><strong>efp_val_label</strong> (<em>torch.Tensor</em><em>, </em><em>optional</em>) – Labels for validation EFP features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing CustomDataset objects for all data types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.data_label_split">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">data_label_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#data_label_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.data_label_split" title="Link to this definition"></a></dt>
<dd><p>Splits the data into features and labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>ndarray</em>) – The data you wish to split into features and labels.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing two ndarrays:</dt><dd><ul class="simple">
<li><p>data: The features of the data.</p></li>
<li><p>labels: The labels of the data.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.detach_device">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">detach_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#detach_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.detach_device" title="Link to this definition"></a></dt>
<dd><p>Detaches a given tensor to ndarray</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tensor</strong> (<em>torch.Tensor</em>) – The PyTorch tensor one wants to convert to a ndarray</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Converted torch.Tensor to ndarray</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.get_device">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">get_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#get_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.get_device" title="Link to this definition"></a></dt>
<dd><p>Returns the appropriate processing device.
If DDP is active, uses the local_rank.
Otherwise, uses cuda:0 if available, else cpu.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The device to be used for processing.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.get_loss">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">get_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#get_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.get_loss" title="Link to this definition"></a></dt>
<dd><p>Returns the loss_object based on the string provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>loss_function</strong> (<em>str</em>) – The loss function you wish to use. Options include:
- ‘mse’: Mean Squared Error
- ‘bce’: Binary Cross Entropy
- ‘mae’: Mean Absolute Error
- ‘huber’: Huber Loss
- ‘l1’: L1 Loss
- ‘l2’: L2 Loss
- ‘smoothl1’: Smooth L1 Loss</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loss function object</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.get_ntxent_outputs">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">get_ntxent_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#get_ntxent_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.get_ntxent_outputs" title="Link to this definition"></a></dt>
<dd><p>Performs a dual forward pass through the model with augmented input views for NT-Xent contrastive learning.</p>
<p>This function:
1. Generates two augmented views of the input data using naive gaussian smearing strategy
2. Passes each view through the model
3. Unpacks the model outputs from each view
4. Returns all necessary outputs for NT-Xent loss calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – The model to perform forward passes with</p></li>
<li><p><strong>inputs</strong> (<em>torch.Tensor</em>) – Input data batch</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Configuration object containing NT-Xent parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>recon_i: Reconstruction from the first view</p></li>
<li><p>mu_i: Mean latent vector from the first view</p></li>
<li><p>logvar_i: Log variance from the first view</p></li>
<li><p>ldj_i: Log-determinant of Jacobian from the first view</p></li>
<li><p>z0_i: Initial latent vector from the first view</p></li>
<li><p>zk_i: Final latent vector from the first view</p></li>
<li><p>zk_j: Final latent vector from the second view</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.get_optimizer">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">get_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#get_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.get_optimizer" title="Link to this definition"></a></dt>
<dd><p>Returns a PyTorch optimizer configured with optimal arguments for training a large VAE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer_name</strong> (<em>str</em>) – One of “adam”, “adamw”, “rmsprop”, “sgd”, “radam”, “adagrad”.</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – The parameters (or parameter groups) of your model.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – The learning rate for the optimizer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instantiated optimizer with specified hyperparameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.optim.Optimizer</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If an unsupported optimizer name is provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.invert_normalize_data">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">invert_normalize_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#invert_normalize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.invert_normalize_data" title="Link to this definition"></a></dt>
<dd><p>Inverts a chained normalization transformation.</p>
<p>This function accepts normalized data (for example, the output of a VAE’s preprocessed input)
and the scaler (or ChainedScaler) that was used to perform the forward transformation.
It then returns the original data by calling the scaler’s inverse_transform method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>normalized_data</strong> (<em>np.ndarray</em>) – The transformed data array.</p></li>
<li><p><strong>scaler</strong> – The scaler object (or a ChainedScaler instance) used for the forward transformation,
which must implement an <cite>inverse_transform</cite> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data mapped back to its original scale.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.load_augment_tensors">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">load_augment_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyword</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#load_augment_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.load_augment_tensors" title="Link to this definition"></a></dt>
<dd><p>Searches through the specified folder for all ‘.pt’ files whose names contain the specified
keyword (e.g., ‘bkg_train’, ‘bkg_test’, or ‘sig_test’). Files are then categorized by whether
their filename contains one of the three substrings: ‘jets’, ‘events’, or ‘constituents’.</p>
<p>For ‘bkg_train’, each file must contain one of the generator names: ‘herwig’, ‘pythia’, or ‘sherpa’.
For each file, the tensor is loaded and a new feature is appended along the last dimension:
- 0 for files containing ‘herwig’
- 1 for files containing ‘pythia’
- 2 for files containing ‘sherpa’</p>
<p>For ‘bkg_test’ and ‘sig_test’, the appended new feature is filled with -1, since generator info
is not available at test time.</p>
<p>Finally, for each category the resulting tensors are concatenated along axis=0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_path</strong> (<em>str</em>) – The path to the folder to search.</p></li>
<li><p><strong>keyword</strong> (<em>str</em>) – The keyword to filter files (e.g., ‘bkg_train’, ‘bkg_test’, or ‘sig_test’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple of three PyTorch tensors: (jets_tensor, events_tensor, constituents_tensor)</dt><dd><p>corresponding to the concatenated tensors for each category.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any category does not have at least one file for each generator type.
    The error message is:
    “required files not found. please run the –mode convert_csv and prepare inputs before retrying”</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.load_model">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#load_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.load_model" title="Link to this definition"></a></dt>
<dd><p>Loads the state dictionary of the trained model into a model variable. This variable is then used for passing
data through the encoding and decoding functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>str</em>) – Path to model</p></li>
<li><p><strong>in_shape</strong> (<em>tuple</em>) – Input shape</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#bead.src.utils.ggl.Config" title="bead.src.utils.ggl.Config"><em>Config</em></a>) – Configuration object</p></li>
</ul>
</dd>
</dl>
<p>Returns: nn.Module: Returns a model object with the attributes of the model class, with the selected state dictionary loaded into it.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.load_tensors">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">load_tensors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sig_test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_efp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#load_tensors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.load_tensors" title="Link to this definition"></a></dt>
<dd><p>Searches through the specified folder for all ‘.pt’ files containing the given keyword in their names.
Categorizes these files based on the presence of ‘jets’, ‘events’, ‘constituents’, or ‘efp’ in their filenames,
loads them into PyTorch tensors, concatenates them along axis=0, and returns the resulting tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder_path</strong> (<em>str</em>) – The path to the folder to search.</p></li>
<li><p><strong>keyword</strong> (<em>str</em>) – The keyword to filter files (‘bkg_train’, ‘bkg_test’, or ‘sig_test’).</p></li>
<li><p><strong>include_efp</strong> (<em>bool</em>) – Whether to include EFP features in loading. Default False for backward compatibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing PyTorch tensors. If include_efp=False: (events, jets, constituents).</dt><dd><p>If include_efp=True: (events, jets, constituents, efp).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any required category (‘jets’, ‘events’, ‘constituents’) has no matching files.
    EFP files are optional and won’t raise errors if missing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.model_init">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">model_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#model_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.model_init" title="Link to this definition"></a></dt>
<dd><p>Initializing the models attributes to a model_object variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<em>str</em>) – The name of the model you wish to initialize. This should correspond to what your Model name.</p></li>
<li><p><strong>init</strong> (<em>str</em>) – The initialization method you wish to use (Xavier support currently). Default is None.</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object with the models class attributes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.normalize_data">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">normalize_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#normalize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.normalize_data" title="Link to this definition"></a></dt>
<dd><p>Normalizes jet data for VAE-based anomaly detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – 2D numpy array (n_jets, n_features)</p></li>
<li><p><strong>normalization_type</strong> – A string indicating the normalization method(s).
It can be a single method or a chain of methods separated by ‘+’.
Valid options include:
‘minmax’  - MinMaxScaler (scales features to [0,1])
‘standard’- StandardScaler (zero mean, unit variance)
‘robust’  - RobustScaler (less sensitive to outliers)
‘log’     - Log1pScaler (applies log1p transformation)
‘l2’      - L2Normalizer (scales each feature by its L2 norm)
‘power’   - PowerTransformer (using Yeo-Johnson)
‘quantile’- QuantileTransformer (transforms features to follow a normal or uniform distribution)
‘maxabs’  - MaxAbsScaler (scales each feature by its maximum absolute value)
‘sincos’  - SinCosTransformer (converts angles to sin/cos features)
Example: ‘log+standard’ applies a log transformation followed by standard scaling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Transformed data array.
scaler: Fitted scaler object (or chained scaler) for inverse transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>normalized_data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.numpy_to_tensor">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">numpy_to_tensor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#numpy_to_tensor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.numpy_to_tensor" title="Link to this definition"></a></dt>
<dd><p>Converts ndarray to torch.Tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>ndarray</em>) – The data you wish to convert from ndarray to torch.Tensor.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Your data as a tensor</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.save_loss_components">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">save_loss_components</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">component_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'loss_outputs'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#save_loss_components"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.save_loss_components" title="Link to this definition"></a></dt>
<dd><p>This function unpacks loss_data into separate components, converts each into a NumPy array,
and saves each array as a .npy file with a filename of the form:
&lt;component_name&gt;_&lt;suffix&gt;.npy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_data</strong> (<em>-</em>) – a list of tuples, where each tuple contains loss components</p></li>
<li><p><strong>component_names</strong> (<em>-</em>) – a list of strings naming each component in the tuple</p></li>
<li><p><strong>suffix</strong> (<em>-</em>) – a string keyword to be appended (separated by ‘_’) to each filename</p></li>
<li><p><strong>save_dir</strong> (<em>-</em>) – directory to save .npy files (default “loss_outputs”)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.save_model">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/bead/src/utils/helper.html#save_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.save_model" title="Link to this definition"></a></dt>
<dd><p>Saves the models state dictionary as a <cite>.pt</cite> file to the given path.
Handles DDP model saving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>nn.Module</em>) – The PyTorch model to save.</p></li>
<li><p><strong>model_path</strong> (<em>str</em>) – String defining the models save path.</p></li>
<li><p><strong>config</strong> (<em>dataClass</em>) – Base class selecting user inputs. Used to check if DDP is active.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Saved model state dictionary as <cite>.pt</cite> file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.select_features">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">select_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jets_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constituents_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#select_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.select_features" title="Link to this definition"></a></dt>
<dd><p>Process the jets_tensor and constituents_tensor based on the input_features flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jets_tensor</strong> (<em>torch.Tensor</em>) – Tensor with features
[evt_id, jet_id, num_constituents, b_tagged, jet_pt, jet_eta, jet_phi_sin, jet_phi_cos, generator_id]</p></li>
<li><p><strong>constituents_tensor</strong> (<em>torch.Tensor</em>) – Tensor with features
[evt_id, jet_id, constit_id, b_tagged, constit_pt, constit_eta, constit_phi_sin, constit_phi_cos, generator_id]</p></li>
<li><p><strong>input_features</strong> (<em>str</em>) – The flag to determine which features to select.
Options:
- ‘all’: return tensors as is.
- ‘4momentum’: select [pt, eta, phi_sin, phi_cos, generator_id] for both.
- ‘4momentum_btag’: select [b_tagged, pt, eta, phi_sin, phi_cos, generator_id] for both.
- ‘pj_custom’: select everything except [evt_id, jet_id] for jets and except [evt_id, jet_id, constit_id] for constituents.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Processed jets_tensor and constituents_tensor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.train_val_split">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">train_val_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#train_val_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.train_val_split" title="Link to this definition"></a></dt>
<dd><p>Splits a tensor into training and validation sets based on the specified train_ratio.
The split is done by sampling indices randomly ensuring that the data is shuffled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> (<em>torch.Tensor</em>) – The input tensor to be split.</p></li>
<li><p><strong>train_ratio</strong> (<em>float</em>) – Proportion of data to be used for training (e.g., 0.8 for 80% training data).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing two tensors:</dt><dd><ul class="simple">
<li><p>train_tensor: Tensor containing the training data.</p></li>
<li><p>val_tensor: Tensor containing the validation data.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If train_ratio is not between 0 and 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.helper.unpack_model_outputs">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.helper.</span></span><span class="sig-name descname"><span class="pre">unpack_model_outputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/helper.html#unpack_model_outputs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.helper.unpack_model_outputs" title="Link to this definition"></a></dt>
<dd><p>Standardizes model outputs to a consistent 6-tuple format regardless of model type.</p>
<p>This function takes the raw outputs from different model types and ensures they all
conform to the standard 6-tuple format: (recon, mu, logvar, ldj, z0, zk).</p>
<p>For models that don’t naturally produce all these values:
- AE models (len(outputs) == 2): Returns (recon, zeros, zeros, zeros, z, z)
- VAE models (len(outputs) == 4): Returns (recon, mu, logvar, zeros, z, z)
- Flow models (len(outputs) == 6): Returns (recon, mu, logvar, ldj, z0, zk)
- Dirichlet VAE (len(outputs) == 6): Returns (recon, mu, logvar, zeros, G_z, D_z)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>outputs</strong> (<em>tuple</em>) – The raw outputs tuple from a model’s forward method.
Could be one of:
- (recon, z) for basic autoencoders (AE, AE_Dropout_BN, ConvAE)
- (recon, mu, logvar, z) for VAEs (ConvVAE)
- (recon, mu, logvar, ldj, z0, zk) for flow-based models (Planar_ConvVAE, etc.)
- (recon, mu, logvar, G_z, G_z, D_z) for Dirichlet_ConvVAE</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A standardized 6-tuple (recon, mu, logvar, ldj, z0, zk) where:</dt><dd><ul class="simple">
<li><p>recon: Reconstructed input</p></li>
<li><p>mu: Mean of the latent distribution (or zeros for AEs)</p></li>
<li><p>logvar: Log variance of the latent distribution (or zeros for AEs)</p></li>
<li><p>ldj: Log determinant of the Jacobian (or zeros for non-flow models)</p></li>
<li><p>z0: Initial sample from the latent distribution (G_z for Dirichlet VAE)</p></li>
<li><p>zk: Final transformed latent variable (D_z for Dirichlet VAE)</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the length of outputs is not 2, 4, or 6.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bead.src.utils.loss">
<span id="bead-src-utils-loss-module"></span><h2>bead.src.utils.loss module<a class="headerlink" href="#module-bead.src.utils.loss" title="Link to this heading"></a></h2>
<p>Loss functions for training autoencoder and VAE models.</p>
<p>This module provides various loss functions for training autoencoders and variational autoencoders,
including basic reconstruction losses, KL divergence, regularization terms, and combined losses
for specialized models like those with normalizing flows.</p>
<dl class="simple">
<dt>Classes:</dt><dd><p>BaseLoss: Base class for all loss functions.
ReconstructionLoss: Standard reconstruction loss (MSE or L1).
KLDivergenceLoss: Kullback-Leibler divergence for VAE training.
WassersteinLoss: Earth Mover’s Distance approximation.
L1Regularization: L1 weight regularization.
L2Regularization: L2 weight regularization.
BinaryCrossEntropyLoss: Binary cross-entropy loss.
VAELoss: Combined loss for VAE (reconstruction + KL).
VAEFlowLoss: Loss for VAE with normalizing flows.
ContrastiveLoss: Contrastive loss for clustering latent vectors.
VAELossEMD: VAE loss with Earth Mover’s Distance term.
VAELossL1: VAE loss with L1 regularization.
VAELossL2: VAE loss with L2 regularization.
VAEFlowLossEMD: VAE flow loss with EMD term.
VAEFlowLossL1: VAE flow loss with L1 regularization.
VAEFlowLossL2: VAE flow loss with L2 regularization.
DVAELoss: Combined loss for DirichletConvVAE (reconstruction + KL(dirichlet)) inherits from VAELoss.
DVAEFlowLoss: Combined loss for DirichletConvVAE (reconstruction + KL(dirichlet)) inherits from VAEFlowLoss.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.BaseLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">BaseLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#BaseLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.BaseLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for all loss functions.
Each subclass must implement the calculate() method.</p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.BaseLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#BaseLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.BaseLoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.BinaryCrossEntropyLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">BinaryCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#BinaryCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.BinaryCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Binary Cross Entropy Loss for binary classification tasks.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>use_logits: Boolean indicating if the predictions are raw logits (default: True).</p></li>
<li><p>reduction: Reduction method for the loss (‘mean’, ‘sum’, etc., default: ‘mean’).</p></li>
</ul>
</dd>
</dl>
<p>Note: Not supported for full_chain mode yet</p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.BinaryCrossEntropyLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#BinaryCrossEntropyLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.BinaryCrossEntropyLoss.calculate" title="Link to this definition"></a></dt>
<dd><p>Calculate the binary cross entropy loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> (<em>Tensor</em>) – Predicted outputs (logits or probabilities).</p></li>
<li><p><strong>targets</strong> (<em>Tensor</em>) – Ground truth binary labels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed binary cross entropy loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.DVAEFlowLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">DVAEFlowLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#DVAEFlowLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.DVAEFlowLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAEFlowLoss" title="bead.src.utils.loss.VAEFlowLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAEFlowLoss</span></code></a></p>
<p>DVAEFlowLoss: Combines reconstruction loss and Dirichlet KL divergence loss.
Inherits from VAEFlowLoss and overrides the KL loss function to use Dirichlet prior.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.DVAELoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">DVAELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#DVAELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.DVAELoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAELoss" title="bead.src.utils.loss.VAELoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAELoss</span></code></a></p>
<p>DVAELoss: Combines reconstruction loss and Dirichlet KL divergence loss.
Inherits from VAELoss and overrides the KL loss function to use Dirichlet prior.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.KLDivergenceLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">KLDivergenceLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'gaussian'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#KLDivergenceLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.KLDivergenceLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>KL Divergence loss for VAE latent space regularization.</p>
<p>Supports:
- Gaussian prior
- Dirichlet prior via Laplace approximation</p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.KLDivergenceLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#KLDivergenceLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.KLDivergenceLoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.KLDivergenceLoss.compute_alpha_laplace">
<span class="sig-name descname"><span class="pre">compute_alpha_laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#KLDivergenceLoss.compute_alpha_laplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.KLDivergenceLoss.compute_alpha_laplace" title="Link to this definition"></a></dt>
<dd><p>Compute Dirichlet concentration parameters α from
Gaussian parameters (μ, logvar) via Laplace bridge approximation.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.L1Regularization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">L1Regularization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#L1Regularization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.L1Regularization" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Computes L1 regularization over model parameters.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>weight: scaling factor for the L1 regularization (default: 1e-4)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.L1Regularization.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#L1Regularization.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.L1Regularization.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.L2Regularization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">L2Regularization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#L2Regularization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.L2Regularization" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Computes L2 regularization over model parameters.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>weight: scaling factor for the L2 regularization (default: 1e-4)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.L2Regularization.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#L2Regularization.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.L2Regularization.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentCombinedLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">NTXentCombinedLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentCombinedLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentCombinedLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Combined loss that adds NT-Xent contrastive loss to any base loss function.</p>
<p>This loss function wraps another loss function (e.g., VAELoss, VAEFlowLoss)
and adds the NT-Xent contrastive loss term between two augmented views of the
latent representations.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>base_loss_function: The name of the base loss function to use (e.g., “VAELoss”)</p></li>
<li><p>ntxent_weight: Weight for the NT-Xent loss term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentCombinedLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_aug1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_aug2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentCombinedLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentCombinedLoss.calculate" title="Link to this definition"></a></dt>
<dd><p>Calculate the combined loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>recon</strong> – Reconstructed input</p></li>
<li><p><strong>target</strong> – Original input</p></li>
<li><p><strong>mu</strong> – Mean of the latent distribution</p></li>
<li><p><strong>logvar</strong> – Log variance of the latent distribution</p></li>
<li><p><strong>zk</strong> – Latent representation (after flows if applicable)</p></li>
<li><p><strong>parameters</strong> – Model parameters (for regularization if applicable)</p></li>
<li><p><strong>z_aug1</strong> – First augmented latent representation</p></li>
<li><p><strong>z_aug2</strong> – Second augmented latent representation</p></li>
<li><p><strong>log_det_jacobian</strong> – Log determinant of Jacobian (for flow models)</p></li>
<li><p><strong>generator_labels</strong> – Labels for the data (if applicable)</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments for the base loss</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Combined loss and component losses</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentDVAEFlowLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">NTXentDVAEFlowLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentDVAEFlowLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentDVAEFlowLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.NTXentCombinedLoss" title="bead.src.utils.loss.NTXentCombinedLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">NTXentCombinedLoss</span></code></a></p>
<p>NTXentDVAEFlowLoss: Combines DVAEFlowLoss with NT-Xent contrastive loss.
Inherits from NTXentCombinedLoss and uses DVAEFlowLoss as the base loss.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentDVAELoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">NTXentDVAELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentDVAELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentDVAELoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.NTXentCombinedLoss" title="bead.src.utils.loss.NTXentCombinedLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">NTXentCombinedLoss</span></code></a></p>
<p>NTXentDVAELoss: Combines DVAELoss with NT-Xent contrastive loss.
Inherits from NTXentCombinedLoss and uses DVAELoss as the base loss.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">NTXentLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>NT-Xent (Normalized Temperature-scaled Cross Entropy) Loss
as used in SimCLR and similar contrastive learning frameworks.</p>
<p>This is an unsupervised contrastive loss that works with augmented views of the same data points.
It pulls together representations of different augmentations of the same sample (positive pairs),
while pushing away representations of different samples (negative pairs).</p>
<p>References:
- SimCLR: <a class="reference external" href="https://arxiv.org/abs/2002.05709">https://arxiv.org/abs/2002.05709</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentLoss.calculate" title="Link to this definition"></a></dt>
<dd><p>Calculate NT-Xent loss for each batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z1</strong> (<em>torch.Tensor</em>) – First set of features/representations, shape [batch_size, feature_dim].</p></li>
<li><p><strong>z2</strong> (<em>torch.Tensor</em>) – Second set of features/representations, shape [batch_size, feature_dim].
These are typically augmented versions of the same inputs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>NT-Xent loss value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentVAEFlowLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">NTXentVAEFlowLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentVAEFlowLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentVAEFlowLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.NTXentCombinedLoss" title="bead.src.utils.loss.NTXentCombinedLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">NTXentCombinedLoss</span></code></a></p>
<p>NTXentVAEFlowLoss: Combines VAE-Flow loss with NT-Xent contrastive loss.
Inherits from NTXentCombinedLoss and uses VAEFlowLoss as the base loss.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.NTXentVAELoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">NTXentVAELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#NTXentVAELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.NTXentVAELoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.NTXentCombinedLoss" title="bead.src.utils.loss.NTXentCombinedLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">NTXentCombinedLoss</span></code></a></p>
<p>NTXentVAELoss: Combines VAE loss with NT-Xent contrastive loss.
Inherits from NTXentCombinedLoss and uses VAELoss as the base loss.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.ReconstructionLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">ReconstructionLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#ReconstructionLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.ReconstructionLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Reconstruction loss for AE/VAE models.
Supports both MSE and L1 losses based on configuration.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>loss_type: ‘mse’ (default) or ‘l1’</p></li>
<li><p>reduction: reduction method (default ‘mean’ or ‘sum’)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.ReconstructionLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#ReconstructionLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.ReconstructionLoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.SupervisedContrastiveLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">SupervisedContrastiveLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#SupervisedContrastiveLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.SupervisedContrastiveLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Supervised Contrastive Learning loss function.
Based on: <a class="reference external" href="https://arxiv.org/abs/2004.11362">https://arxiv.org/abs/2004.11362</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.SupervisedContrastiveLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#SupervisedContrastiveLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.SupervisedContrastiveLoss.calculate" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<em>torch.Tensor</em>) – Latent vectors (e.g., zk), shape [batch_size, feature_dim].Assumed to be L2-normalized.</p></li>
<li><p><strong>labels</strong> (<em>torch.Tensor</em>) – Ground truth labels (generator_ids), shape [batch_size].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Supervised contrastive loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAEFlowLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Loss for VAE models augmented with a normalizing flow.
Includes the log_det_jacobian term from the flow transformation.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>reconstruction: dict for ReconstructionLoss config.</p></li>
<li><p>kl: dict for KLDivergenceLoss config.</p></li>
<li><p>kl_weight: weight for the KL divergence term.</p></li>
<li><p>flow_weight: weight for the log_det_jacobian term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLossEMD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAEFlowLossEMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLossEMD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLossEMD" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAEFlowLoss" title="bead.src.utils.loss.VAEFlowLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAEFlowLoss</span></code></a></p>
<p>VAE loss augmented with an Earth Mover’s Distance (EMD) term.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>emd_weight: weight for the EMD term.</p></li>
<li><p>emd: dict for WassersteinLoss config.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLossEMD.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLossEMD.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLossEMD.calculate" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>In addition to the standard VAE inputs, this loss requires:</dt><dd><ul class="simple">
<li><p>emd_p: first distribution tensor (e.g. a predicted histogram)</p></li>
<li><p>emd_q: second distribution tensor (e.g. a target histogram)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLossL1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAEFlowLossL1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLossL1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLossL1" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAEFlowLoss" title="bead.src.utils.loss.VAEFlowLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAEFlowLoss</span></code></a></p>
<p>VAE loss augmented with an L1 regularization term.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>l1_weight: weight for the L1 regularization term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLossL1.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLossL1.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLossL1.calculate" title="Link to this definition"></a></dt>
<dd><p>‘parameters’ should be a list of model parameters to regularize.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLossL2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAEFlowLossL2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLossL2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLossL2" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAEFlowLoss" title="bead.src.utils.loss.VAEFlowLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAEFlowLoss</span></code></a></p>
<p>VAE loss augmented with an L2 regularization term.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>l2_weight: weight for the L2 regularization term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowLossL2.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowLossL2.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowLossL2.calculate" title="Link to this definition"></a></dt>
<dd><p>‘parameters’ should be a list of model parameters to regularize.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowSupConLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAEFlowSupConLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowSupConLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowSupConLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Combined loss for VAE with Normalizing Flows and Supervised Contrastive Learning.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>vaeflow: dict for VAEFlowLoss config.</p></li>
<li><p>supcon: dict for SupervisedContrastiveLoss config.</p></li>
<li><p>contrastive_weight: weight for the contrastive loss term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAEFlowSupConLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAEFlowSupConLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAEFlowSupConLoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Total loss for VAE training.
Combines reconstruction loss and KL divergence loss.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>reconstruction: dict for ReconstructionLoss config.</p></li>
<li><p>kl: dict for KLDivergenceLoss config.</p></li>
<li><p>kl_weight: scaling factor for KL loss (default: 1.0)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELossEMD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAELossEMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELossEMD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELossEMD" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAELoss" title="bead.src.utils.loss.VAELoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAELoss</span></code></a></p>
<p>VAE loss augmented with an Earth Mover’s Distance (EMD) term.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>emd_weight: weight for the EMD term.</p></li>
<li><p>emd: dict for WassersteinLoss config.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELossEMD.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELossEMD.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELossEMD.calculate" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>In addition to the standard VAE inputs, this loss requires:</dt><dd><ul class="simple">
<li><p>emd_p: first distribution tensor (e.g. a predicted histogram)</p></li>
<li><p>emd_q: second distribution tensor (e.g. a target histogram)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELossL1">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAELossL1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELossL1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELossL1" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAELoss" title="bead.src.utils.loss.VAELoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAELoss</span></code></a></p>
<p>VAE loss augmented with an L1 regularization term.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>l1_weight: weight for the L1 regularization term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELossL1.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELossL1.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELossL1.calculate" title="Link to this definition"></a></dt>
<dd><p>‘parameters’ should be a list of model parameters to regularize.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELossL2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAELossL2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELossL2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELossL2" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.VAELoss" title="bead.src.utils.loss.VAELoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">VAELoss</span></code></a></p>
<p>VAE loss augmented with an L2 regularization term.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>l2_weight: weight for the L2 regularization term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAELossL2.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAELossL2.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAELossL2.calculate" title="Link to this definition"></a></dt>
<dd><p>‘parameters’ should be a list of model parameters to regularize.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAESupConLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">VAESupConLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAESupConLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAESupConLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Combined loss for VAE with Supervised Contrastive Learning.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>vae: dict for VAELoss config.</p></li>
<li><p>supcon: dict for SupervisedContrastiveLoss config.</p></li>
<li><p>contrastive_weight: weight for the contrastive loss term.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.VAESupConLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_det_jacobian</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generator_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#VAESupConLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.VAESupConLoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="bead.src.utils.loss.WassersteinLoss">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">bead.src.utils.loss.</span></span><span class="sig-name descname"><span class="pre">WassersteinLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#WassersteinLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.WassersteinLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#bead.src.utils.loss.BaseLoss" title="bead.src.utils.loss.BaseLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLoss</span></code></a></p>
<p>Computes an approximation of the Earth Mover’s Distance (Wasserstein Loss)
between two 1D probability distributions.</p>
<p>Assumes inputs are tensors of shape (batch_size, n) representing histograms or distributions.</p>
<dl class="simple">
<dt>Config parameters:</dt><dd><ul class="simple">
<li><p>dim: dimension along which to compute the cumulative sum (default: 1)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="bead.src.utils.loss.WassersteinLoss.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/loss.html#WassersteinLoss.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.loss.WassersteinLoss.calculate" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-bead.src.utils.normalization">
<span id="bead-src-utils-normalization-module"></span><h2>bead.src.utils.normalization module<a class="headerlink" href="#module-bead.src.utils.normalization" title="Link to this heading"></a></h2>
<p>Custom normalization functions for HEP data.</p>
<p>This module provides specialized normalization functions for high-energy physics data,
particularly for jet and constituent features. These functions handle the specific
requirements of features like PT, eta, and phi in particle physics analyses.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>normalize_jet_pj_custom: Custom normalization for jet data.
normalize_constit_pj_custom: Custom normalization for constituent data.
invert_normalize_jet_pj_custom: Invert custom jet normalization.
invert_normalize_constit_pj_custom: Invert custom constituent normalization.</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.normalization.invert_normalize_constit_pj_custom">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.normalization.</span></span><span class="sig-name descname"><span class="pre">invert_normalize_constit_pj_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/normalization.html#invert_normalize_constit_pj_custom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.normalization.invert_normalize_constit_pj_custom" title="Link to this definition"></a></dt>
<dd><p>Inverts the normalization applied by normalize_jet_data_np_chained.</p>
<dl class="simple">
<dt>The input normalized_data is assumed to be a NumPy array of shape (N, 8) with columns:</dt><dd><p>0: event_id              (unchanged)
1: jet_id                (unchanged)
2: num_constituents_norm (normalized via “robust”)
3: b_tagged              (unchanged)
4: jet_pt_norm           (normalized via “log+standard”)
5: jet_eta_norm          (normalized via “standard”)
6-7: jet_phi_sin, jet_phi_cos (normalized via “sin_cos”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>NumPy array of shape (N, 7) with columns:</dt><dd><p>[event_id, jet_id, num_constituents, b_tagged, jet_pt, jet_eta, jet_phi]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>original_data</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The scaler for jet_pt (chain “log+standard”) is expected to invert first the StandardScaler then the Log1pScaler,
so that the original jet_pt is recovered.</p></li>
<li><p>The scaler for jet_phi (chain “sin_cos”) converts the 2 columns back to the original angle using arctan2.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.normalization.invert_normalize_jet_pj_custom">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.normalization.</span></span><span class="sig-name descname"><span class="pre">invert_normalize_jet_pj_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">normalized_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/normalization.html#invert_normalize_jet_pj_custom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.normalization.invert_normalize_jet_pj_custom" title="Link to this definition"></a></dt>
<dd><p>Inverts the normalization applied by normalize_jet_data_np_chained.</p>
<dl class="simple">
<dt>The input normalized_data is assumed to be a NumPy array of shape (N, 8) with columns:</dt><dd><p>0: event_id              (unchanged)
1: jet_id                (unchanged)
2: num_constituents_norm (normalized via “robust”)
3: b_tagged              (unchanged)
4: jet_pt_norm           (normalized via “log+standard”)
5: jet_eta_norm          (normalized via “standard”)
6-7: jet_phi_sin, jet_phi_cos (normalized via “sin_cos”)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>NumPy array of shape (N, 7) with columns:</dt><dd><p>[event_id, jet_id, num_constituents, b_tagged, jet_pt, jet_eta, jet_phi]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>original_data</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The scaler for jet_pt (chain “log+standard”) is expected to invert first the StandardScaler then the Log1pScaler,
so that the original jet_pt is recovered.</p></li>
<li><p>The scaler for jet_phi (chain “sin_cos”) converts the 2 columns back to the original angle using arctan2.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.normalization.normalize_constit_pj_custom">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.normalization.</span></span><span class="sig-name descname"><span class="pre">normalize_constit_pj_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/normalization.html#normalize_constit_pj_custom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.normalization.normalize_constit_pj_custom" title="Link to this definition"></a></dt>
<dd><p>Normalizes jet data for HEP analysis using a chained normalization approach.</p>
<dl class="simple">
<dt>Input data is expected as a NumPy array of shape (N, 7) with columns in the order:</dt><dd><p>0: event_id         (unchanged)
1: jet_id           (unchanged)
2: constit_id       (unchanged)
3: b_tagged         (unchanged)
4: constit_pt           (to be normalized via “log+standard”)
5: constit_eta          (to be normalized via “standard”)
6: constit_phi          (to be normalized via “sin_cos” transformation)</p>
</dd>
<dt>The output array will have 8 columns:</dt><dd><p>[event_id, jet_id, constit_id, b_tagged, constit_pt_norm, constit_eta_norm, constit_phi_sin, constit_phi_cos]</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.ndarray</em>) – Input array of shape (N, 7).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output array of shape (N, 8).
scalers (dict): Dictionary containing the fitted scalers for each feature.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>normalized_data (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.normalization.normalize_jet_pj_custom">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.normalization.</span></span><span class="sig-name descname"><span class="pre">normalize_jet_pj_custom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/normalization.html#normalize_jet_pj_custom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.normalization.normalize_jet_pj_custom" title="Link to this definition"></a></dt>
<dd><p>Normalizes jet data for HEP analysis using a chained normalization approach.</p>
<p>Input data is expected as a NumPy array of shape (N, 7) with columns in the order:
0: event_id         (unchanged)
1: jet_id           (unchanged)
2: num_constituents (to be normalized via “robust”)
3: b_tagged         (already integer; left unchanged)
4: jet_pt           (to be normalized via “log+standard”)
5: jet_eta          (to be normalized via “standard”)
6: jet_phi          (to be normalized via “sin_cos” transformation)</p>
<p>The output array will have 8 columns:
[event_id, jet_id, num_constituents_norm, b_tagged, jet_pt_norm, jet_eta_norm, jet_phi_sin, jet_phi_cos]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.ndarray</em>) – Input array of shape (N, 7).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Output array of shape (N, 8).
scalers (dict): Dictionary containing the fitted scalers for each feature.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>normalized_data (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bead.src.utils.plotting">
<span id="bead-src-utils-plotting-module"></span><h2>bead.src.utils.plotting module<a class="headerlink" href="#module-bead.src.utils.plotting" title="Link to this heading"></a></h2>
<p>Visualization utilities for model results.</p>
<p>This module provides functions for creating visualizations of model training results,
latent space embeddings, and performance metrics. These plots are essential for
understanding model behavior and evaluating anomaly detection performance.</p>
<dl class="simple">
<dt>Functions:</dt><dd><p>plot_losses: Generate plots for training and validation losses.
reduce_dim_subsampled: Reduce dimensionality with optional subsampling.
plot_latent_variables: Visualize latent space embeddings.
plot_mu_logvar: Plot latent space mean and variance.
plot_roc_curve: Generate ROC curves from model results.</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.plotting.plot_latent_variables">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_latent_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/plotting.html#plot_latent_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.plotting.plot_latent_variables" title="Link to this definition"></a></dt>
<dd><p>Visualize latent space embeddings from the model.</p>
<p>This function creates 2D projections of the latent space using dimensionality
reduction techniques (PCA, t-SNE, UMap or TriMap) for both initial (z0) and final (zk)
latent variables, color-coded by class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>object</em>) – Configuration object containing parameters like latent_space_size,
latent_space_plot_style, input_level, etc.</p></li>
<li><p><strong>paths</strong> (<em>dict</em>) – Dictionary of paths including output_path and data_path</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress and debugging information, default is False</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function handles both training and test data, with different color
schemes for each. For test data, signal samples are shown in red, while
background samples are colored according to their generator type.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.plotting.plot_losses">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_losses</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/plotting.html#plot_losses"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.plotting.plot_losses" title="Link to this definition"></a></dt>
<dd><p>Generate plots for training and validation losses over epochs.</p>
<p>This function creates two types of visualizations:
1. Training and validation total loss curves per epoch
2. Component-wise loss curves (reconstruction, KL divergence, etc.) for train/val/test sets</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>str</em>) – Directory containing the saved model output files (.npy)</p></li>
<li><p><strong>save_dir</strong> (<em>str</em>) – Directory where the generated plots will be saved</p></li>
<li><p><strong>config</strong> (<em>object</em>) – Configuration object containing model parameters like project_name and epochs</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress messages, default is False</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If required loss data files are not found in the output directory</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.plotting.plot_mu_logvar">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_mu_logvar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/plotting.html#plot_mu_logvar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.plotting.plot_mu_logvar" title="Link to this definition"></a></dt>
<dd><p>Visualize the mean (mu) and log-variance (logvar) of the latent space distribution.</p>
<p>This function creates two types of visualizations:
1. 2D projection of the mean vectors in latent space, color-coded by class
2. Histogram of uncertainties derived from the log-variance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>object</em>) – Configuration object containing parameters like latent_space_size,
latent_space_plot_style, input_level, etc.</p></li>
<li><p><strong>paths</strong> (<em>dict</em>) – Dictionary of paths including output_path and data_path</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress and debugging information, default is False</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The uncertainty is calculated as the mean of the standard deviation (sigma)
across all dimensions of the latent space, where sigma = exp(0.5 * logvar).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.plotting.plot_roc_curve">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_roc_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/plotting.html#plot_roc_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.plotting.plot_roc_curve" title="Link to this definition"></a></dt>
<dd><p>Generate and save ROC curves for available loss component files.</p>
<p>This function computes and plots Receiver Operating Characteristic (ROC) curves
for different loss components, evaluating their effectiveness as anomaly scores.</p>
<p>If config.overlay_roc is True, it also generates an overlay plot comparing ROC curves
across different projects specified in config.overlay_roc_projects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>object</em>) – Configuration object containing parameters like input_level and project_name</p></li>
<li><p><strong>paths</strong> (<em>dict</em>) – Dictionary containing paths, particularly output_path</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print additional debug information, default is False</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If the required label file is not found</p></li>
<li><p><strong>ValueError</strong> – If ground truth labels are not a 1D array or if there’s a length mismatch
    between loss scores and ground truth labels</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function generates a single plot containing ROC curves for all available
loss components (total loss, reconstruction loss, KL divergence, etc.),
with the area under the curve (AUC) displayed in the legend.</p>
<p>If overlay_roc is enabled, it also creates a combined plot showing ROC curves
from multiple projects for comparison.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bead.src.utils.plotting.reduce_dim_subsampled">
<span class="sig-prename descclassname"><span class="pre">bead.src.utils.plotting.</span></span><span class="sig-name descname"><span class="pre">reduce_dim_subsampled</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trimap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bead/src/utils/plotting.html#reduce_dim_subsampled"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bead.src.utils.plotting.reduce_dim_subsampled" title="Link to this definition"></a></dt>
<dd><p>Reduce dimensionality of data with optional subsampling for large datasets.</p>
<p>This function applies dimensionality reduction techniques (PCA, t-SNE, TriMap, or UMAP)
to high-dimensional data, with options for subsampling large datasets to improve
computational efficiency. It will use GPU-accelerated methods when available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>numpy.ndarray</em>) – Input data of shape (n_samples, n_features)</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – Dimensionality reduction method to use: “pca”, “tsne”, “trimap”, or “umap”, default is “tsne”</p></li>
<li><p><strong>n_components</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of dimensions to reduce to, default is 2</p></li>
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to use (subsampling), if None uses all data, default is None</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print progress messages, default is False</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.ndarray</em> – Reduced data with shape (n_samples, n_components)</p></li>
<li><p><em>str</em> – The name of the dimensionality reduction method used</p></li>
<li><p><em>numpy.ndarray</em> – Indices of the samples used for subsampling</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If an invalid dimensionality reduction method is specified</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bead.src.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-bead.src.utils" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bead.src.trainers.html" class="btn btn-neutral float-left" title="bead.src.trainers package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Pratik Jawahar.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>